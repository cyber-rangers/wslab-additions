# Exploiting Windows Server 2008 R2 Domain Controller

## About the lab

Have a secondary "old" domain controller for exploiting.

## LabConfig

```PowerShell
$LabConfig=@{ DomainAdminName='LabAdmin'; AdminPassword='P@ssw0rd'; DomainName='cyberdefense-rangers.local'; DomainNetbiosName='RANGERS'; Prefix = 'ThreatHunting-'; SwitchName = 'LabSwitch'; DCEdition='4'; Internet=$true ; AdditionalNetworksConfig=@(); VMs=@()}

$LabConfig.VMs += @{ VMName = 'ForeignDC8R2' ; Configuration = 'Simple'; ParentVHD = 'Win2008R2SP1_G1.vhdx' ; MemoryStartupBytes= 1GB ; MGMTNICs=1; AddToolsVHD=$True; Unattend="NoDjoin" ; Generation = 1; AdditionalLocalAdmin='LabAdmin'}
 
```

## Scenario

Run the following command directly on ForeignDC8R2

```PowerShell
set-executionpolicy unrestricted -force -confirm:$false
cmd /c netsh interface ip set address "Local Area Connection" static 172.16.0.1 255.255.255.0 10.0.0.1
cmd /c netsh interface ip add dns "Local Area Connection" 10.0.0.1
. D:\Scripts\Install-TAFirst2008R2DomainController.ps1
Install-TAFirst2008R2DomainController -Domain partner.local -NetBiosDomainName PARTNER -ADSite 'Nebrasca' -Domainlevel 4 -ForestLevel 4 -DSSafeModePassword 'P@ssw0rd'

```